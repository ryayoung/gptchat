var ft=Object.defineProperty;var dt=(s,e,t)=>e in s?ft(s,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):s[e]=t;var f=(s,e,t)=>(dt(s,typeof e!="symbol"?e+"":e,t),t),gt=(s,e,t)=>{if(!e.has(s))throw TypeError("Cannot "+t)};var ne=(s,e,t)=>{if(e.has(s))throw TypeError("Cannot add the same private member more than once");e instanceof WeakSet?e.add(s):e.set(s,t)};var q=(s,e,t)=>(gt(s,e,"access private method"),t);import _e from"https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/es/highlight.min.js";import{io as mt}from"https://cdn.socket.io/4.7.2/socket.io.esm.min.js";(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const r of document.querySelectorAll('link[rel="modulepreload"]'))n(r);new MutationObserver(r=>{for(const o of r)if(o.type==="childList")for(const i of o.addedNodes)i.tagName==="LINK"&&i.rel==="modulepreload"&&n(i)}).observe(document,{childList:!0,subtree:!0});function t(r){const o={};return r.integrity&&(o.integrity=r.integrity),r.referrerPolicy&&(o.referrerPolicy=r.referrerPolicy),r.crossOrigin==="use-credentials"?o.credentials="include":r.crossOrigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function n(r){if(r.ep)return;r.ep=!0;const o=t(r);fetch(r.href,o)}})();const kt="modulepreload",xt=function(s){return"/"+s},$e={},bt=function(e,t,n){let r=Promise.resolve();if(t&&t.length>0){const o=document.getElementsByTagName("link");r=Promise.all(t.map(i=>{if(i=xt(i),i in $e)return;$e[i]=!0;const l=i.endsWith(".css"),a=l?'[rel="stylesheet"]':"";if(!!n)for(let h=o.length-1;h>=0;h--){const p=o[h];if(p.href===i&&(!l||p.rel==="stylesheet"))return}else if(document.querySelector(`link[href="${i}"]${a}`))return;const c=document.createElement("link");if(c.rel=l?"stylesheet":kt,l||(c.as="script",c.crossOrigin=""),c.href=i,document.head.appendChild(c),l)return new Promise((h,p)=>{c.addEventListener("load",h),c.addEventListener("error",()=>p(new Error(`Unable to preload CSS for ${i}`)))})}))}return r.then(()=>e()).catch(o=>{const i=new Event("vite:preloadError",{cancelable:!0});if(i.payload=o,window.dispatchEvent(i),!i.defaultPrevented)throw o})};function V(){}function wt(s,e){for(const t in e)s[t]=e[t];return s}function qe(s){return s()}function Te(){return Object.create(null)}function F(s){s.forEach(qe)}function Ne(s){return typeof s=="function"}function yt(s,e){return s!=s?e==e:s!==e||s&&typeof s=="object"||typeof s=="function"}let N;function us(s,e){return s===e?!0:(N||(N=document.createElement("a")),N.href=e,s===N.href)}function _t(s){return Object.keys(s).length===0}function $t(s,...e){if(s==null){for(const n of e)n(void 0);return V}const t=s.subscribe(...e);return t.unsubscribe?()=>t.unsubscribe():t}function hs(s,e,t){s.$$.on_destroy.push($t(e,t))}function ps(s,e,t,n){if(s){const r=Ze(s,e,t,n);return s[0](r)}}function Ze(s,e,t,n){return s[1]&&n?wt(t.ctx.slice(),s[1](n(e))):t.ctx}function fs(s,e,t,n){if(s[2]&&n){const r=s[2](n(t));if(e.dirty===void 0)return r;if(typeof r=="object"){const o=[],i=Math.max(e.dirty.length,r.length);for(let l=0;l<i;l+=1)o[l]=e.dirty[l]|r[l];return o}return e.dirty|r}return e.dirty}function ds(s,e,t,n,r,o){if(r){const i=Ze(e,t,n,o);s.p(i,r)}}function gs(s){if(s.ctx.length>32){const e=[],t=s.ctx.length/32;for(let n=0;n<t;n++)e[n]=-1;return e}return-1}function ms(s,e){s.appendChild(e)}function Tt(s,e,t){s.insertBefore(e,t||null)}function He(s){s.parentNode&&s.parentNode.removeChild(s)}function ks(s,e){for(let t=0;t<s.length;t+=1)s[t]&&s[t].d(e)}function xs(s){return document.createElement(s)}function bs(s){return document.createElementNS("http://www.w3.org/2000/svg",s)}function je(s){return document.createTextNode(s)}function ws(){return je(" ")}function St(){return je("")}function ys(s,e,t,n){return s.addEventListener(e,t,n),()=>s.removeEventListener(e,t,n)}function _s(s,e,t){t==null?s.removeAttribute(e):s.getAttribute(e)!==t&&s.setAttribute(e,t)}function vt(s){return Array.from(s.childNodes)}function $s(s,e){e=""+e,s.data!==e&&(s.data=e)}function Ts(s,e,t,n){t==null?s.style.removeProperty(e):s.style.setProperty(e,t,n?"important":"")}function Ss(s,e,t){s.classList.toggle(e,!!t)}function Et(s,e,{bubbles:t=!1,cancelable:n=!1}={}){return new CustomEvent(s,{detail:e,bubbles:t,cancelable:n})}function Se(s,e){return new s(e)}let D;function M(s){D=s}function Qe(){if(!D)throw new Error("Function called outside component initialization");return D}function Rt(s){Qe().$$.on_mount.push(s)}function vs(){const s=Qe();return(e,t,{cancelable:n=!1}={})=>{const r=s.$$.callbacks[e];if(r){const o=Et(e,t,{cancelable:n});return r.slice().forEach(i=>{i.call(s,o)}),!o.defaultPrevented}return!0}}const I=[],ve=[];let A=[];const Ee=[],Ge=Promise.resolve();let ie=!1;function Ve(){ie||(ie=!0,Ge.then(We))}function Re(){return Ve(),Ge}function oe(s){A.push(s)}const se=new Set;let R=0;function We(){if(R!==0)return;const s=D;do{try{for(;R<I.length;){const e=I[R];R++,M(e),zt(e.$$)}}catch(e){throw I.length=0,R=0,e}for(M(null),I.length=0,R=0;ve.length;)ve.pop()();for(let e=0;e<A.length;e+=1){const t=A[e];se.has(t)||(se.add(t),t())}A.length=0}while(I.length);for(;Ee.length;)Ee.pop()();ie=!1,se.clear(),M(s)}function zt(s){if(s.fragment!==null){s.update(),F(s.before_update);const e=s.dirty;s.dirty=[-1],s.fragment&&s.fragment.p(s.ctx,e),s.after_update.forEach(oe)}}function It(s){const e=[],t=[];A.forEach(n=>s.indexOf(n)===-1?e.push(n):t.push(n)),t.forEach(n=>n()),A=e}const Q=new Set;let S;function At(){S={r:0,c:[],p:S}}function Ct(){S.r||F(S.c),S=S.p}function le(s,e){s&&s.i&&(Q.delete(s),s.i(e))}function ze(s,e,t,n){if(s&&s.o){if(Q.has(s))return;Q.add(s),S.c.push(()=>{Q.delete(s),n&&(t&&s.d(1),n())}),s.o(e)}else n&&n()}function Ie(s){s&&s.c()}function ae(s,e,t){const{fragment:n,after_update:r}=s.$$;n&&n.m(e,t),oe(()=>{const o=s.$$.on_mount.map(qe).filter(Ne);s.$$.on_destroy?s.$$.on_destroy.push(...o):F(o),s.$$.on_mount=[]}),r.forEach(oe)}function ce(s,e){const t=s.$$;t.fragment!==null&&(It(t.after_update),F(t.on_destroy),t.fragment&&t.fragment.d(e),t.on_destroy=t.fragment=null,t.ctx=[])}function Mt(s,e){s.$$.dirty[0]===-1&&(I.push(s),Ve(),s.$$.dirty.fill(0)),s.$$.dirty[e/31|0]|=1<<e%31}function Pt(s,e,t,n,r,o,i=null,l=[-1]){const a=D;M(s);const u=s.$$={fragment:null,ctx:[],props:o,update:V,not_equal:r,bound:Te(),on_mount:[],on_destroy:[],on_disconnect:[],before_update:[],after_update:[],context:new Map(e.context||(a?a.$$.context:[])),callbacks:Te(),dirty:l,skip_bound:!1,root:e.target||a.$$.root};i&&i(u.root);let c=!1;if(u.ctx=t?t(s,e.props||{},(h,p,...d)=>{const x=d.length?d[0]:p;return u.ctx&&r(u.ctx[h],u.ctx[h]=x)&&(!u.skip_bound&&u.bound[h]&&u.bound[h](x),c&&Mt(s,h)),p}):[],u.update(),c=!0,F(u.before_update),u.fragment=n?n(u.ctx):!1,e.target){if(e.hydrate){const h=vt(e.target);u.fragment&&u.fragment.l(h),h.forEach(He)}else u.fragment&&u.fragment.c();e.intro&&le(s.$$.fragment),ae(s,e.target,e.anchor),We()}M(a)}class Lt{constructor(){f(this,"$$");f(this,"$$set")}$destroy(){ce(this,1),this.$destroy=V}$on(e,t){if(!Ne(t))return V;const n=this.$$.callbacks[e]||(this.$$.callbacks[e]=[]);return n.push(t),()=>{const r=n.indexOf(t);r!==-1&&n.splice(r,1)}}$set(e){this.$$set&&!_t(e)&&(this.$$.skip_bound=!0,this.$$set(e),this.$$.skip_bound=!1)}}const Dt="4";typeof window<"u"&&(window.__svelte||(window.__svelte={v:new Set})).v.add(Dt);let Z;const Ot=new Uint8Array(16);function Ft(){if(!Z&&(Z=typeof crypto<"u"&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto),!Z))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return Z(Ot)}const k=[];for(let s=0;s<256;++s)k.push((s+256).toString(16).slice(1));function Ut(s,e=0){return k[s[e+0]]+k[s[e+1]]+k[s[e+2]]+k[s[e+3]]+"-"+k[s[e+4]]+k[s[e+5]]+"-"+k[s[e+6]]+k[s[e+7]]+"-"+k[s[e+8]]+k[s[e+9]]+"-"+k[s[e+10]]+k[s[e+11]]+k[s[e+12]]+k[s[e+13]]+k[s[e+14]]+k[s[e+15]]}const Bt=typeof crypto<"u"&&crypto.randomUUID&&crypto.randomUUID.bind(crypto),Ae={randomUUID:Bt};function qt(s,e,t){if(Ae.randomUUID&&!e&&!s)return Ae.randomUUID();s=s||{};const n=s.random||(s.rng||Ft)();if(n[6]=n[6]&15|64,n[8]=n[8]&63|128,e){t=t||0;for(let r=0;r<16;++r)e[t+r]=n[r];return e}return Ut(n)}function re(){}const G=qt,Nt=/^\w*(Error|Exception|An error):/,Zt=/^Traceback \(most recent call last\):/;function Ht(s){return Nt.test(s)||Zt.test(s)}function jt(s,e){return s.reduce((t,n)=>(t[n[e]]=n,t),{})}function Qt(s,e){s.splice(0,s.length,...e)}function Ce(s,e){return new Promise((t,n)=>{const r=new FileReader;r.onload=o=>{var l;const i=(l=o.target)==null?void 0:l.result;i!=null?t(i):n(new Error("File read resulted in null data"))},r.onerror=o=>{var i,l;n(new Error(`Error reading file: ${((l=(i=o.target)==null?void 0:i.error)==null?void 0:l.message)||"Unknown error"}`))},r[`readAs${e}`](s)})}function Gt(s,e="",t=!1){let n=document.createElement("input");n.type="file",n.accept=e,n.multiple=t,n.onchange=async r=>{const o=r.target.files;if(o&&o.length>0)return s(t?Array.from(o):o[0])},n.click()}function Vt(s){try{const e=localStorage.getItem(s);return JSON.parse(e)}catch{return null}}function Wt(s,e){try{localStorage.setItem(s,JSON.stringify(e))}catch(t){console.error(t)}}function pe(){return{async:!1,breaks:!1,extensions:null,gfm:!0,hooks:null,pedantic:!1,renderer:null,silent:!1,tokenizer:null,walkTokens:null}}let E=pe();function Je(s){E=s}const Xe=/[&<>"']/,Jt=new RegExp(Xe.source,"g"),Ke=/[<>"']|&(?!(#\d{1,7}|#[Xx][a-fA-F0-9]{1,6}|\w+);)/,Xt=new RegExp(Ke.source,"g"),Kt={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"},Me=s=>Kt[s];function w(s,e){if(e){if(Xe.test(s))return s.replace(Jt,Me)}else if(Ke.test(s))return s.replace(Xt,Me);return s}const Yt=/&(#(?:\d+)|(?:#x[0-9A-Fa-f]+)|(?:\w+));?/ig;function en(s){return s.replace(Yt,(e,t)=>(t=t.toLowerCase(),t==="colon"?":":t.charAt(0)==="#"?t.charAt(1)==="x"?String.fromCharCode(parseInt(t.substring(2),16)):String.fromCharCode(+t.substring(1)):""))}const tn=/(^|[^\[])\^/g;function m(s,e){let t=typeof s=="string"?s:s.source;e=e||"";const n={replace:(r,o)=>{let i=typeof o=="string"?o:o.source;return i=i.replace(tn,"$1"),t=t.replace(r,i),n},getRegex:()=>new RegExp(t,e)};return n}function Pe(s){try{s=encodeURI(s).replace(/%25/g,"%")}catch{return null}return s}const P={exec:()=>null};function Le(s,e){const t=s.replace(/\|/g,(o,i,l)=>{let a=!1,u=i;for(;--u>=0&&l[u]==="\\";)a=!a;return a?"|":" |"}),n=t.split(/ \|/);let r=0;if(n[0].trim()||n.shift(),n.length>0&&!n[n.length-1].trim()&&n.pop(),e)if(n.length>e)n.splice(e);else for(;n.length<e;)n.push("");for(;r<n.length;r++)n[r]=n[r].trim().replace(/\\\|/g,"|");return n}function H(s,e,t){const n=s.length;if(n===0)return"";let r=0;for(;r<n;){const o=s.charAt(n-r-1);if(o===e&&!t)r++;else if(o!==e&&t)r++;else break}return s.slice(0,n-r)}function nn(s,e){if(s.indexOf(e[1])===-1)return-1;let t=0;for(let n=0;n<s.length;n++)if(s[n]==="\\")n++;else if(s[n]===e[0])t++;else if(s[n]===e[1]&&(t--,t<0))return n;return-1}function De(s,e,t,n){const r=e.href,o=e.title?w(e.title):null,i=s[1].replace(/\\([\[\]])/g,"$1");if(s[0].charAt(0)!=="!"){n.state.inLink=!0;const l={type:"link",raw:t,href:r,title:o,text:i,tokens:n.inlineTokens(i)};return n.state.inLink=!1,l}return{type:"image",raw:t,href:r,title:o,text:w(i)}}function sn(s,e){const t=s.match(/^(\s+)(?:```)/);if(t===null)return e;const n=t[1];return e.split(`
`).map(r=>{const o=r.match(/^\s+/);if(o===null)return r;const[i]=o;return i.length>=n.length?r.slice(n.length):r}).join(`
`)}class W{constructor(e){f(this,"options");f(this,"rules");f(this,"lexer");this.options=e||E}space(e){const t=this.rules.block.newline.exec(e);if(t&&t[0].length>0)return{type:"space",raw:t[0]}}code(e){const t=this.rules.block.code.exec(e);if(t){const n=t[0].replace(/^ {1,4}/gm,"");return{type:"code",raw:t[0],codeBlockStyle:"indented",text:this.options.pedantic?n:H(n,`
`)}}}fences(e){const t=this.rules.block.fences.exec(e);if(t){const n=t[0],r=sn(n,t[3]||"");return{type:"code",raw:n,lang:t[2]?t[2].trim().replace(this.rules.inline.anyPunctuation,"$1"):t[2],text:r}}}heading(e){const t=this.rules.block.heading.exec(e);if(t){let n=t[2].trim();if(/#$/.test(n)){const r=H(n,"#");(this.options.pedantic||!r||/ $/.test(r))&&(n=r.trim())}return{type:"heading",raw:t[0],depth:t[1].length,text:n,tokens:this.lexer.inline(n)}}}hr(e){const t=this.rules.block.hr.exec(e);if(t)return{type:"hr",raw:t[0]}}blockquote(e){const t=this.rules.block.blockquote.exec(e);if(t){const n=H(t[0].replace(/^ *>[ \t]?/gm,""),`
`),r=this.lexer.state.top;this.lexer.state.top=!0;const o=this.lexer.blockTokens(n);return this.lexer.state.top=r,{type:"blockquote",raw:t[0],tokens:o,text:n}}}list(e){let t=this.rules.block.list.exec(e);if(t){let n=t[1].trim();const r=n.length>1,o={type:"list",raw:"",ordered:r,start:r?+n.slice(0,-1):"",loose:!1,items:[]};n=r?`\\d{1,9}\\${n.slice(-1)}`:`\\${n}`,this.options.pedantic&&(n=r?n:"[*+-]");const i=new RegExp(`^( {0,3}${n})((?:[	 ][^\\n]*)?(?:\\n|$))`);let l="",a="",u=!1;for(;e;){let c=!1;if(!(t=i.exec(e))||this.rules.block.hr.test(e))break;l=t[0],e=e.substring(l.length);let h=t[2].split(`
`,1)[0].replace(/^\t+/,ee=>" ".repeat(3*ee.length)),p=e.split(`
`,1)[0],d=0;this.options.pedantic?(d=2,a=h.trimStart()):(d=t[2].search(/[^ ]/),d=d>4?1:d,a=h.slice(d),d+=t[1].length);let x=!1;if(!h&&/^ *$/.test(p)&&(l+=p+`
`,e=e.substring(p.length+1),c=!0),!c){const ee=new RegExp(`^ {0,${Math.min(3,d-1)}}(?:[*+-]|\\d{1,9}[.)])((?:[ 	][^\\n]*)?(?:\\n|$))`),be=new RegExp(`^ {0,${Math.min(3,d-1)}}((?:- *){3,}|(?:_ *){3,}|(?:\\* *){3,})(?:\\n+|$)`),we=new RegExp(`^ {0,${Math.min(3,d-1)}}(?:\`\`\`|~~~)`),ye=new RegExp(`^ {0,${Math.min(3,d-1)}}#`);for(;e;){const te=e.split(`
`,1)[0];if(p=te,this.options.pedantic&&(p=p.replace(/^ {1,4}(?=( {4})*[^ ])/g,"  ")),we.test(p)||ye.test(p)||ee.test(p)||be.test(e))break;if(p.search(/[^ ]/)>=d||!p.trim())a+=`
`+p.slice(d);else{if(x||h.search(/[^ ]/)>=4||we.test(h)||ye.test(h)||be.test(h))break;a+=`
`+p}!x&&!p.trim()&&(x=!0),l+=te+`
`,e=e.substring(te.length+1),h=p.slice(d)}}o.loose||(u?o.loose=!0:/\n *\n *$/.test(l)&&(u=!0));let b=null,T;this.options.gfm&&(b=/^\[[ xX]\] /.exec(a),b&&(T=b[0]!=="[ ] ",a=a.replace(/^\[[ xX]\] +/,""))),o.items.push({type:"list_item",raw:l,task:!!b,checked:T,loose:!1,text:a,tokens:[]}),o.raw+=l}o.items[o.items.length-1].raw=l.trimEnd(),o.items[o.items.length-1].text=a.trimEnd(),o.raw=o.raw.trimEnd();for(let c=0;c<o.items.length;c++)if(this.lexer.state.top=!1,o.items[c].tokens=this.lexer.blockTokens(o.items[c].text,[]),!o.loose){const h=o.items[c].tokens.filter(d=>d.type==="space"),p=h.length>0&&h.some(d=>/\n.*\n/.test(d.raw));o.loose=p}if(o.loose)for(let c=0;c<o.items.length;c++)o.items[c].loose=!0;return o}}html(e){const t=this.rules.block.html.exec(e);if(t)return{type:"html",block:!0,raw:t[0],pre:t[1]==="pre"||t[1]==="script"||t[1]==="style",text:t[0]}}def(e){const t=this.rules.block.def.exec(e);if(t){const n=t[1].toLowerCase().replace(/\s+/g," "),r=t[2]?t[2].replace(/^<(.*)>$/,"$1").replace(this.rules.inline.anyPunctuation,"$1"):"",o=t[3]?t[3].substring(1,t[3].length-1).replace(this.rules.inline.anyPunctuation,"$1"):t[3];return{type:"def",tag:n,raw:t[0],href:r,title:o}}}table(e){const t=this.rules.block.table.exec(e);if(!t||!/[:|]/.test(t[2]))return;const n=Le(t[1]),r=t[2].replace(/^\||\| *$/g,"").split("|"),o=t[3]&&t[3].trim()?t[3].replace(/\n[ \t]*$/,"").split(`
`):[],i={type:"table",raw:t[0],header:[],align:[],rows:[]};if(n.length===r.length){for(const l of r)/^ *-+: *$/.test(l)?i.align.push("right"):/^ *:-+: *$/.test(l)?i.align.push("center"):/^ *:-+ *$/.test(l)?i.align.push("left"):i.align.push(null);for(const l of n)i.header.push({text:l,tokens:this.lexer.inline(l)});for(const l of o)i.rows.push(Le(l,i.header.length).map(a=>({text:a,tokens:this.lexer.inline(a)})));return i}}lheading(e){const t=this.rules.block.lheading.exec(e);if(t)return{type:"heading",raw:t[0],depth:t[2].charAt(0)==="="?1:2,text:t[1],tokens:this.lexer.inline(t[1])}}paragraph(e){const t=this.rules.block.paragraph.exec(e);if(t){const n=t[1].charAt(t[1].length-1)===`
`?t[1].slice(0,-1):t[1];return{type:"paragraph",raw:t[0],text:n,tokens:this.lexer.inline(n)}}}text(e){const t=this.rules.block.text.exec(e);if(t)return{type:"text",raw:t[0],text:t[0],tokens:this.lexer.inline(t[0])}}escape(e){const t=this.rules.inline.escape.exec(e);if(t)return{type:"escape",raw:t[0],text:w(t[1])}}tag(e){const t=this.rules.inline.tag.exec(e);if(t)return!this.lexer.state.inLink&&/^<a /i.test(t[0])?this.lexer.state.inLink=!0:this.lexer.state.inLink&&/^<\/a>/i.test(t[0])&&(this.lexer.state.inLink=!1),!this.lexer.state.inRawBlock&&/^<(pre|code|kbd|script)(\s|>)/i.test(t[0])?this.lexer.state.inRawBlock=!0:this.lexer.state.inRawBlock&&/^<\/(pre|code|kbd|script)(\s|>)/i.test(t[0])&&(this.lexer.state.inRawBlock=!1),{type:"html",raw:t[0],inLink:this.lexer.state.inLink,inRawBlock:this.lexer.state.inRawBlock,block:!1,text:t[0]}}link(e){const t=this.rules.inline.link.exec(e);if(t){const n=t[2].trim();if(!this.options.pedantic&&/^</.test(n)){if(!/>$/.test(n))return;const i=H(n.slice(0,-1),"\\");if((n.length-i.length)%2===0)return}else{const i=nn(t[2],"()");if(i>-1){const a=(t[0].indexOf("!")===0?5:4)+t[1].length+i;t[2]=t[2].substring(0,i),t[0]=t[0].substring(0,a).trim(),t[3]=""}}let r=t[2],o="";if(this.options.pedantic){const i=/^([^'"]*[^\s])\s+(['"])(.*)\2/.exec(r);i&&(r=i[1],o=i[3])}else o=t[3]?t[3].slice(1,-1):"";return r=r.trim(),/^</.test(r)&&(this.options.pedantic&&!/>$/.test(n)?r=r.slice(1):r=r.slice(1,-1)),De(t,{href:r&&r.replace(this.rules.inline.anyPunctuation,"$1"),title:o&&o.replace(this.rules.inline.anyPunctuation,"$1")},t[0],this.lexer)}}reflink(e,t){let n;if((n=this.rules.inline.reflink.exec(e))||(n=this.rules.inline.nolink.exec(e))){const r=(n[2]||n[1]).replace(/\s+/g," "),o=t[r.toLowerCase()];if(!o){const i=n[0].charAt(0);return{type:"text",raw:i,text:i}}return De(n,o,n[0],this.lexer)}}emStrong(e,t,n=""){let r=this.rules.inline.emStrongLDelim.exec(e);if(!r||r[3]&&n.match(/[\p{L}\p{N}]/u))return;if(!(r[1]||r[2]||"")||!n||this.rules.inline.punctuation.exec(n)){const i=[...r[0]].length-1;let l,a,u=i,c=0;const h=r[0][0]==="*"?this.rules.inline.emStrongRDelimAst:this.rules.inline.emStrongRDelimUnd;for(h.lastIndex=0,t=t.slice(-1*e.length+i);(r=h.exec(t))!=null;){if(l=r[1]||r[2]||r[3]||r[4]||r[5]||r[6],!l)continue;if(a=[...l].length,r[3]||r[4]){u+=a;continue}else if((r[5]||r[6])&&i%3&&!((i+a)%3)){c+=a;continue}if(u-=a,u>0)continue;a=Math.min(a,a+u+c);const p=[...r[0]][0].length,d=e.slice(0,i+r.index+p+a);if(Math.min(i,a)%2){const b=d.slice(1,-1);return{type:"em",raw:d,text:b,tokens:this.lexer.inlineTokens(b)}}const x=d.slice(2,-2);return{type:"strong",raw:d,text:x,tokens:this.lexer.inlineTokens(x)}}}}codespan(e){const t=this.rules.inline.code.exec(e);if(t){let n=t[2].replace(/\n/g," ");const r=/[^ ]/.test(n),o=/^ /.test(n)&&/ $/.test(n);return r&&o&&(n=n.substring(1,n.length-1)),n=w(n,!0),{type:"codespan",raw:t[0],text:n}}}br(e){const t=this.rules.inline.br.exec(e);if(t)return{type:"br",raw:t[0]}}del(e){const t=this.rules.inline.del.exec(e);if(t)return{type:"del",raw:t[0],text:t[2],tokens:this.lexer.inlineTokens(t[2])}}autolink(e){const t=this.rules.inline.autolink.exec(e);if(t){let n,r;return t[2]==="@"?(n=w(t[1]),r="mailto:"+n):(n=w(t[1]),r=n),{type:"link",raw:t[0],text:n,href:r,tokens:[{type:"text",raw:n,text:n}]}}}url(e){var n;let t;if(t=this.rules.inline.url.exec(e)){let r,o;if(t[2]==="@")r=w(t[0]),o="mailto:"+r;else{let i;do i=t[0],t[0]=((n=this.rules.inline._backpedal.exec(t[0]))==null?void 0:n[0])??"";while(i!==t[0]);r=w(t[0]),t[1]==="www."?o="http://"+t[0]:o=t[0]}return{type:"link",raw:t[0],text:r,href:o,tokens:[{type:"text",raw:r,text:r}]}}}inlineText(e){const t=this.rules.inline.text.exec(e);if(t){let n;return this.lexer.state.inRawBlock?n=t[0]:n=w(t[0]),{type:"text",raw:t[0],text:n}}}}const rn=/^(?: *(?:\n|$))+/,on=/^( {4}[^\n]+(?:\n(?: *(?:\n|$))*)?)+/,ln=/^ {0,3}(`{3,}(?=[^`\n]*(?:\n|$))|~{3,})([^\n]*)(?:\n|$)(?:|([\s\S]*?)(?:\n|$))(?: {0,3}\1[~`]* *(?=\n|$)|$)/,U=/^ {0,3}((?:-[\t ]*){3,}|(?:_[ \t]*){3,}|(?:\*[ \t]*){3,})(?:\n+|$)/,an=/^ {0,3}(#{1,6})(?=\s|$)(.*)(?:\n+|$)/,Ye=/(?:[*+-]|\d{1,9}[.)])/,et=m(/^(?!bull )((?:.|\n(?!\s*?\n|bull ))+?)\n {0,3}(=+|-+) *(?:\n+|$)/).replace(/bull/g,Ye).getRegex(),fe=/^([^\n]+(?:\n(?!hr|heading|lheading|blockquote|fences|list|html|table| +\n)[^\n]+)*)/,cn=/^[^\n]+/,de=/(?!\s*\])(?:\\.|[^\[\]\\])+/,un=m(/^ {0,3}\[(label)\]: *(?:\n *)?([^<\s][^\s]*|<.*?>)(?:(?: +(?:\n *)?| *\n *)(title))? *(?:\n+|$)/).replace("label",de).replace("title",/(?:"(?:\\"?|[^"\\])*"|'[^'\n]*(?:\n[^'\n]+)*\n?'|\([^()]*\))/).getRegex(),hn=m(/^( {0,3}bull)([ \t][^\n]+?)?(?:\n|$)/).replace(/bull/g,Ye).getRegex(),Y="address|article|aside|base|basefont|blockquote|body|caption|center|col|colgroup|dd|details|dialog|dir|div|dl|dt|fieldset|figcaption|figure|footer|form|frame|frameset|h[1-6]|head|header|hr|html|iframe|legend|li|link|main|menu|menuitem|meta|nav|noframes|ol|optgroup|option|p|param|section|source|summary|table|tbody|td|tfoot|th|thead|title|tr|track|ul",ge=/<!--(?!-?>)[\s\S]*?(?:-->|$)/,pn=m("^ {0,3}(?:<(script|pre|style|textarea)[\\s>][\\s\\S]*?(?:</\\1>[^\\n]*\\n+|$)|comment[^\\n]*(\\n+|$)|<\\?[\\s\\S]*?(?:\\?>\\n*|$)|<![A-Z][\\s\\S]*?(?:>\\n*|$)|<!\\[CDATA\\[[\\s\\S]*?(?:\\]\\]>\\n*|$)|</?(tag)(?: +|\\n|/?>)[\\s\\S]*?(?:(?:\\n *)+\\n|$)|<(?!script|pre|style|textarea)([a-z][\\w-]*)(?:attribute)*? */?>(?=[ \\t]*(?:\\n|$))[\\s\\S]*?(?:(?:\\n *)+\\n|$)|</(?!script|pre|style|textarea)[a-z][\\w-]*\\s*>(?=[ \\t]*(?:\\n|$))[\\s\\S]*?(?:(?:\\n *)+\\n|$))","i").replace("comment",ge).replace("tag",Y).replace("attribute",/ +[a-zA-Z:_][\w.:-]*(?: *= *"[^"\n]*"| *= *'[^'\n]*'| *= *[^\s"'=<>`]+)?/).getRegex(),tt=m(fe).replace("hr",U).replace("heading"," {0,3}#{1,6}(?:\\s|$)").replace("|lheading","").replace("|table","").replace("blockquote"," {0,3}>").replace("fences"," {0,3}(?:`{3,}(?=[^`\\n]*\\n)|~{3,})[^\\n]*\\n").replace("list"," {0,3}(?:[*+-]|1[.)]) ").replace("html","</?(?:tag)(?: +|\\n|/?>)|<(?:script|pre|style|textarea|!--)").replace("tag",Y).getRegex(),fn=m(/^( {0,3}> ?(paragraph|[^\n]*)(?:\n|$))+/).replace("paragraph",tt).getRegex(),me={blockquote:fn,code:on,def:un,fences:ln,heading:an,hr:U,html:pn,lheading:et,list:hn,newline:rn,paragraph:tt,table:P,text:cn},Oe=m("^ *([^\\n ].*)\\n {0,3}((?:\\| *)?:?-+:? *(?:\\| *:?-+:? *)*(?:\\| *)?)(?:\\n((?:(?! *\\n|hr|heading|blockquote|code|fences|list|html).*(?:\\n|$))*)\\n*|$)").replace("hr",U).replace("heading"," {0,3}#{1,6}(?:\\s|$)").replace("blockquote"," {0,3}>").replace("code"," {4}[^\\n]").replace("fences"," {0,3}(?:`{3,}(?=[^`\\n]*\\n)|~{3,})[^\\n]*\\n").replace("list"," {0,3}(?:[*+-]|1[.)]) ").replace("html","</?(?:tag)(?: +|\\n|/?>)|<(?:script|pre|style|textarea|!--)").replace("tag",Y).getRegex(),dn={...me,table:Oe,paragraph:m(fe).replace("hr",U).replace("heading"," {0,3}#{1,6}(?:\\s|$)").replace("|lheading","").replace("table",Oe).replace("blockquote"," {0,3}>").replace("fences"," {0,3}(?:`{3,}(?=[^`\\n]*\\n)|~{3,})[^\\n]*\\n").replace("list"," {0,3}(?:[*+-]|1[.)]) ").replace("html","</?(?:tag)(?: +|\\n|/?>)|<(?:script|pre|style|textarea|!--)").replace("tag",Y).getRegex()},gn={...me,html:m(`^ *(?:comment *(?:\\n|\\s*$)|<(tag)[\\s\\S]+?</\\1> *(?:\\n{2,}|\\s*$)|<tag(?:"[^"]*"|'[^']*'|\\s[^'"/>\\s]*)*?/?> *(?:\\n{2,}|\\s*$))`).replace("comment",ge).replace(/tag/g,"(?!(?:a|em|strong|small|s|cite|q|dfn|abbr|data|time|code|var|samp|kbd|sub|sup|i|b|u|mark|ruby|rt|rp|bdi|bdo|span|br|wbr|ins|del|img)\\b)\\w+(?!:|[^\\w\\s@]*@)\\b").getRegex(),def:/^ *\[([^\]]+)\]: *<?([^\s>]+)>?(?: +(["(][^\n]+[")]))? *(?:\n+|$)/,heading:/^(#{1,6})(.*)(?:\n+|$)/,fences:P,lheading:/^(.+?)\n {0,3}(=+|-+) *(?:\n+|$)/,paragraph:m(fe).replace("hr",U).replace("heading",` *#{1,6} *[^
]`).replace("lheading",et).replace("|table","").replace("blockquote"," {0,3}>").replace("|fences","").replace("|list","").replace("|html","").replace("|tag","").getRegex()},nt=/^\\([!"#$%&'()*+,\-./:;<=>?@\[\]\\^_`{|}~])/,mn=/^(`+)([^`]|[^`][\s\S]*?[^`])\1(?!`)/,st=/^( {2,}|\\)\n(?!\s*$)/,kn=/^(`+|[^`])(?:(?= {2,}\n)|[\s\S]*?(?:(?=[\\<!\[`*_]|\b_|$)|[^ ](?= {2,}\n)))/,B="\\p{P}$+<=>`^|~",xn=m(/^((?![*_])[\spunctuation])/,"u").replace(/punctuation/g,B).getRegex(),bn=/\[[^[\]]*?\]\([^\(\)]*?\)|`[^`]*?`|<[^<>]*?>/g,wn=m(/^(?:\*+(?:((?!\*)[punct])|[^\s*]))|^_+(?:((?!_)[punct])|([^\s_]))/,"u").replace(/punct/g,B).getRegex(),yn=m("^[^_*]*?__[^_*]*?\\*[^_*]*?(?=__)|[^*]+(?=[^*])|(?!\\*)[punct](\\*+)(?=[\\s]|$)|[^punct\\s](\\*+)(?!\\*)(?=[punct\\s]|$)|(?!\\*)[punct\\s](\\*+)(?=[^punct\\s])|[\\s](\\*+)(?!\\*)(?=[punct])|(?!\\*)[punct](\\*+)(?!\\*)(?=[punct])|[^punct\\s](\\*+)(?=[^punct\\s])","gu").replace(/punct/g,B).getRegex(),_n=m("^[^_*]*?\\*\\*[^_*]*?_[^_*]*?(?=\\*\\*)|[^_]+(?=[^_])|(?!_)[punct](_+)(?=[\\s]|$)|[^punct\\s](_+)(?!_)(?=[punct\\s]|$)|(?!_)[punct\\s](_+)(?=[^punct\\s])|[\\s](_+)(?!_)(?=[punct])|(?!_)[punct](_+)(?!_)(?=[punct])","gu").replace(/punct/g,B).getRegex(),$n=m(/\\([punct])/,"gu").replace(/punct/g,B).getRegex(),Tn=m(/^<(scheme:[^\s\x00-\x1f<>]*|email)>/).replace("scheme",/[a-zA-Z][a-zA-Z0-9+.-]{1,31}/).replace("email",/[a-zA-Z0-9.!#$%&'*+/=?^_`{|}~-]+(@)[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(?:\.[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?)+(?![-_])/).getRegex(),Sn=m(ge).replace("(?:-->|$)","-->").getRegex(),vn=m("^comment|^</[a-zA-Z][\\w:-]*\\s*>|^<[a-zA-Z][\\w-]*(?:attribute)*?\\s*/?>|^<\\?[\\s\\S]*?\\?>|^<![a-zA-Z]+\\s[\\s\\S]*?>|^<!\\[CDATA\\[[\\s\\S]*?\\]\\]>").replace("comment",Sn).replace("attribute",/\s+[a-zA-Z:_][\w.:-]*(?:\s*=\s*"[^"]*"|\s*=\s*'[^']*'|\s*=\s*[^\s"'=<>`]+)?/).getRegex(),J=/(?:\[(?:\\.|[^\[\]\\])*\]|\\.|`[^`]*`|[^\[\]\\`])*?/,En=m(/^!?\[(label)\]\(\s*(href)(?:\s+(title))?\s*\)/).replace("label",J).replace("href",/<(?:\\.|[^\n<>\\])+>|[^\s\x00-\x1f]*/).replace("title",/"(?:\\"?|[^"\\])*"|'(?:\\'?|[^'\\])*'|\((?:\\\)?|[^)\\])*\)/).getRegex(),rt=m(/^!?\[(label)\]\[(ref)\]/).replace("label",J).replace("ref",de).getRegex(),it=m(/^!?\[(ref)\](?:\[\])?/).replace("ref",de).getRegex(),Rn=m("reflink|nolink(?!\\()","g").replace("reflink",rt).replace("nolink",it).getRegex(),ke={_backpedal:P,anyPunctuation:$n,autolink:Tn,blockSkip:bn,br:st,code:mn,del:P,emStrongLDelim:wn,emStrongRDelimAst:yn,emStrongRDelimUnd:_n,escape:nt,link:En,nolink:it,punctuation:xn,reflink:rt,reflinkSearch:Rn,tag:vn,text:kn,url:P},zn={...ke,link:m(/^!?\[(label)\]\((.*?)\)/).replace("label",J).getRegex(),reflink:m(/^!?\[(label)\]\s*\[([^\]]*)\]/).replace("label",J).getRegex()},ue={...ke,escape:m(nt).replace("])","~|])").getRegex(),url:m(/^((?:ftp|https?):\/\/|www\.)(?:[a-zA-Z0-9\-]+\.?)+[^\s<]*|^email/,"i").replace("email",/[A-Za-z0-9._+-]+(@)[a-zA-Z0-9-_]+(?:\.[a-zA-Z0-9-_]*[a-zA-Z0-9])+(?![-_])/).getRegex(),_backpedal:/(?:[^?!.,:;*_'"~()&]+|\([^)]*\)|&(?![a-zA-Z0-9]+;$)|[?!.,:;*_'"~)]+(?!$))+/,del:/^(~~?)(?=[^\s~])([\s\S]*?[^\s~])\1(?=[^~]|$)/,text:/^([`~]+|[^`~])(?:(?= {2,}\n)|(?=[a-zA-Z0-9.!#$%&'*+\/=?_`{\|}~-]+@)|[\s\S]*?(?:(?=[\\<!\[`*~_]|\b_|https?:\/\/|ftp:\/\/|www\.|$)|[^ ](?= {2,}\n)|[^a-zA-Z0-9.!#$%&'*+\/=?_`{\|}~-](?=[a-zA-Z0-9.!#$%&'*+\/=?_`{\|}~-]+@)))/},In={...ue,br:m(st).replace("{2,}","*").getRegex(),text:m(ue.text).replace("\\b_","\\b_| {2,}\\n").replace(/\{2,\}/g,"*").getRegex()},j={normal:me,gfm:dn,pedantic:gn},C={normal:ke,gfm:ue,breaks:In,pedantic:zn};class _{constructor(e){f(this,"tokens");f(this,"options");f(this,"state");f(this,"tokenizer");f(this,"inlineQueue");this.tokens=[],this.tokens.links=Object.create(null),this.options=e||E,this.options.tokenizer=this.options.tokenizer||new W,this.tokenizer=this.options.tokenizer,this.tokenizer.options=this.options,this.tokenizer.lexer=this,this.inlineQueue=[],this.state={inLink:!1,inRawBlock:!1,top:!0};const t={block:j.normal,inline:C.normal};this.options.pedantic?(t.block=j.pedantic,t.inline=C.pedantic):this.options.gfm&&(t.block=j.gfm,this.options.breaks?t.inline=C.breaks:t.inline=C.gfm),this.tokenizer.rules=t}static get rules(){return{block:j,inline:C}}static lex(e,t){return new _(t).lex(e)}static lexInline(e,t){return new _(t).inlineTokens(e)}lex(e){e=e.replace(/\r\n|\r/g,`
`),this.blockTokens(e,this.tokens);for(let t=0;t<this.inlineQueue.length;t++){const n=this.inlineQueue[t];this.inlineTokens(n.src,n.tokens)}return this.inlineQueue=[],this.tokens}blockTokens(e,t=[]){this.options.pedantic?e=e.replace(/\t/g,"    ").replace(/^ +$/gm,""):e=e.replace(/^( *)(\t+)/gm,(l,a,u)=>a+"    ".repeat(u.length));let n,r,o,i;for(;e;)if(!(this.options.extensions&&this.options.extensions.block&&this.options.extensions.block.some(l=>(n=l.call({lexer:this},e,t))?(e=e.substring(n.raw.length),t.push(n),!0):!1))){if(n=this.tokenizer.space(e)){e=e.substring(n.raw.length),n.raw.length===1&&t.length>0?t[t.length-1].raw+=`
`:t.push(n);continue}if(n=this.tokenizer.code(e)){e=e.substring(n.raw.length),r=t[t.length-1],r&&(r.type==="paragraph"||r.type==="text")?(r.raw+=`
`+n.raw,r.text+=`
`+n.text,this.inlineQueue[this.inlineQueue.length-1].src=r.text):t.push(n);continue}if(n=this.tokenizer.fences(e)){e=e.substring(n.raw.length),t.push(n);continue}if(n=this.tokenizer.heading(e)){e=e.substring(n.raw.length),t.push(n);continue}if(n=this.tokenizer.hr(e)){e=e.substring(n.raw.length),t.push(n);continue}if(n=this.tokenizer.blockquote(e)){e=e.substring(n.raw.length),t.push(n);continue}if(n=this.tokenizer.list(e)){e=e.substring(n.raw.length),t.push(n);continue}if(n=this.tokenizer.html(e)){e=e.substring(n.raw.length),t.push(n);continue}if(n=this.tokenizer.def(e)){e=e.substring(n.raw.length),r=t[t.length-1],r&&(r.type==="paragraph"||r.type==="text")?(r.raw+=`
`+n.raw,r.text+=`
`+n.raw,this.inlineQueue[this.inlineQueue.length-1].src=r.text):this.tokens.links[n.tag]||(this.tokens.links[n.tag]={href:n.href,title:n.title});continue}if(n=this.tokenizer.table(e)){e=e.substring(n.raw.length),t.push(n);continue}if(n=this.tokenizer.lheading(e)){e=e.substring(n.raw.length),t.push(n);continue}if(o=e,this.options.extensions&&this.options.extensions.startBlock){let l=1/0;const a=e.slice(1);let u;this.options.extensions.startBlock.forEach(c=>{u=c.call({lexer:this},a),typeof u=="number"&&u>=0&&(l=Math.min(l,u))}),l<1/0&&l>=0&&(o=e.substring(0,l+1))}if(this.state.top&&(n=this.tokenizer.paragraph(o))){r=t[t.length-1],i&&r.type==="paragraph"?(r.raw+=`
`+n.raw,r.text+=`
`+n.text,this.inlineQueue.pop(),this.inlineQueue[this.inlineQueue.length-1].src=r.text):t.push(n),i=o.length!==e.length,e=e.substring(n.raw.length);continue}if(n=this.tokenizer.text(e)){e=e.substring(n.raw.length),r=t[t.length-1],r&&r.type==="text"?(r.raw+=`
`+n.raw,r.text+=`
`+n.text,this.inlineQueue.pop(),this.inlineQueue[this.inlineQueue.length-1].src=r.text):t.push(n);continue}if(e){const l="Infinite loop on byte: "+e.charCodeAt(0);if(this.options.silent){console.error(l);break}else throw new Error(l)}}return this.state.top=!0,t}inline(e,t=[]){return this.inlineQueue.push({src:e,tokens:t}),t}inlineTokens(e,t=[]){let n,r,o,i=e,l,a,u;if(this.tokens.links){const c=Object.keys(this.tokens.links);if(c.length>0)for(;(l=this.tokenizer.rules.inline.reflinkSearch.exec(i))!=null;)c.includes(l[0].slice(l[0].lastIndexOf("[")+1,-1))&&(i=i.slice(0,l.index)+"["+"a".repeat(l[0].length-2)+"]"+i.slice(this.tokenizer.rules.inline.reflinkSearch.lastIndex))}for(;(l=this.tokenizer.rules.inline.blockSkip.exec(i))!=null;)i=i.slice(0,l.index)+"["+"a".repeat(l[0].length-2)+"]"+i.slice(this.tokenizer.rules.inline.blockSkip.lastIndex);for(;(l=this.tokenizer.rules.inline.anyPunctuation.exec(i))!=null;)i=i.slice(0,l.index)+"++"+i.slice(this.tokenizer.rules.inline.anyPunctuation.lastIndex);for(;e;)if(a||(u=""),a=!1,!(this.options.extensions&&this.options.extensions.inline&&this.options.extensions.inline.some(c=>(n=c.call({lexer:this},e,t))?(e=e.substring(n.raw.length),t.push(n),!0):!1))){if(n=this.tokenizer.escape(e)){e=e.substring(n.raw.length),t.push(n);continue}if(n=this.tokenizer.tag(e)){e=e.substring(n.raw.length),r=t[t.length-1],r&&n.type==="text"&&r.type==="text"?(r.raw+=n.raw,r.text+=n.text):t.push(n);continue}if(n=this.tokenizer.link(e)){e=e.substring(n.raw.length),t.push(n);continue}if(n=this.tokenizer.reflink(e,this.tokens.links)){e=e.substring(n.raw.length),r=t[t.length-1],r&&n.type==="text"&&r.type==="text"?(r.raw+=n.raw,r.text+=n.text):t.push(n);continue}if(n=this.tokenizer.emStrong(e,i,u)){e=e.substring(n.raw.length),t.push(n);continue}if(n=this.tokenizer.codespan(e)){e=e.substring(n.raw.length),t.push(n);continue}if(n=this.tokenizer.br(e)){e=e.substring(n.raw.length),t.push(n);continue}if(n=this.tokenizer.del(e)){e=e.substring(n.raw.length),t.push(n);continue}if(n=this.tokenizer.autolink(e)){e=e.substring(n.raw.length),t.push(n);continue}if(!this.state.inLink&&(n=this.tokenizer.url(e))){e=e.substring(n.raw.length),t.push(n);continue}if(o=e,this.options.extensions&&this.options.extensions.startInline){let c=1/0;const h=e.slice(1);let p;this.options.extensions.startInline.forEach(d=>{p=d.call({lexer:this},h),typeof p=="number"&&p>=0&&(c=Math.min(c,p))}),c<1/0&&c>=0&&(o=e.substring(0,c+1))}if(n=this.tokenizer.inlineText(o)){e=e.substring(n.raw.length),n.raw.slice(-1)!=="_"&&(u=n.raw.slice(-1)),a=!0,r=t[t.length-1],r&&r.type==="text"?(r.raw+=n.raw,r.text+=n.text):t.push(n);continue}if(e){const c="Infinite loop on byte: "+e.charCodeAt(0);if(this.options.silent){console.error(c);break}else throw new Error(c)}}return t}}class X{constructor(e){f(this,"options");this.options=e||E}code(e,t,n){var o;const r=(o=(t||"").match(/^\S*/))==null?void 0:o[0];return e=e.replace(/\n$/,"")+`
`,r?'<pre><code class="language-'+w(r)+'">'+(n?e:w(e,!0))+`</code></pre>
`:"<pre><code>"+(n?e:w(e,!0))+`</code></pre>
`}blockquote(e){return`<blockquote>
${e}</blockquote>
`}html(e,t){return e}heading(e,t,n){return`<h${t}>${e}</h${t}>
`}hr(){return`<hr>
`}list(e,t,n){const r=t?"ol":"ul",o=t&&n!==1?' start="'+n+'"':"";return"<"+r+o+`>
`+e+"</"+r+`>
`}listitem(e,t,n){return`<li>${e}</li>
`}checkbox(e){return"<input "+(e?'checked="" ':"")+'disabled="" type="checkbox">'}paragraph(e){return`<p>${e}</p>
`}table(e,t){return t&&(t=`<tbody>${t}</tbody>`),`<table>
<thead>
`+e+`</thead>
`+t+`</table>
`}tablerow(e){return`<tr>
${e}</tr>
`}tablecell(e,t){const n=t.header?"th":"td";return(t.align?`<${n} align="${t.align}">`:`<${n}>`)+e+`</${n}>
`}strong(e){return`<strong>${e}</strong>`}em(e){return`<em>${e}</em>`}codespan(e){return`<code>${e}</code>`}br(){return"<br>"}del(e){return`<del>${e}</del>`}link(e,t,n){const r=Pe(e);if(r===null)return n;e=r;let o='<a href="'+e+'"';return t&&(o+=' title="'+t+'"'),o+=">"+n+"</a>",o}image(e,t,n){const r=Pe(e);if(r===null)return n;e=r;let o=`<img src="${e}" alt="${n}"`;return t&&(o+=` title="${t}"`),o+=">",o}text(e){return e}}class xe{strong(e){return e}em(e){return e}codespan(e){return e}del(e){return e}html(e){return e}text(e){return e}link(e,t,n){return""+n}image(e,t,n){return""+n}br(){return""}}class ${constructor(e){f(this,"options");f(this,"renderer");f(this,"textRenderer");this.options=e||E,this.options.renderer=this.options.renderer||new X,this.renderer=this.options.renderer,this.renderer.options=this.options,this.textRenderer=new xe}static parse(e,t){return new $(t).parse(e)}static parseInline(e,t){return new $(t).parseInline(e)}parse(e,t=!0){let n="";for(let r=0;r<e.length;r++){const o=e[r];if(this.options.extensions&&this.options.extensions.renderers&&this.options.extensions.renderers[o.type]){const i=o,l=this.options.extensions.renderers[i.type].call({parser:this},i);if(l!==!1||!["space","hr","heading","code","table","blockquote","list","html","paragraph","text"].includes(i.type)){n+=l||"";continue}}switch(o.type){case"space":continue;case"hr":{n+=this.renderer.hr();continue}case"heading":{const i=o;n+=this.renderer.heading(this.parseInline(i.tokens),i.depth,en(this.parseInline(i.tokens,this.textRenderer)));continue}case"code":{const i=o;n+=this.renderer.code(i.text,i.lang,!!i.escaped);continue}case"table":{const i=o;let l="",a="";for(let c=0;c<i.header.length;c++)a+=this.renderer.tablecell(this.parseInline(i.header[c].tokens),{header:!0,align:i.align[c]});l+=this.renderer.tablerow(a);let u="";for(let c=0;c<i.rows.length;c++){const h=i.rows[c];a="";for(let p=0;p<h.length;p++)a+=this.renderer.tablecell(this.parseInline(h[p].tokens),{header:!1,align:i.align[p]});u+=this.renderer.tablerow(a)}n+=this.renderer.table(l,u);continue}case"blockquote":{const i=o,l=this.parse(i.tokens);n+=this.renderer.blockquote(l);continue}case"list":{const i=o,l=i.ordered,a=i.start,u=i.loose;let c="";for(let h=0;h<i.items.length;h++){const p=i.items[h],d=p.checked,x=p.task;let b="";if(p.task){const T=this.renderer.checkbox(!!d);u?p.tokens.length>0&&p.tokens[0].type==="paragraph"?(p.tokens[0].text=T+" "+p.tokens[0].text,p.tokens[0].tokens&&p.tokens[0].tokens.length>0&&p.tokens[0].tokens[0].type==="text"&&(p.tokens[0].tokens[0].text=T+" "+p.tokens[0].tokens[0].text)):p.tokens.unshift({type:"text",text:T+" "}):b+=T+" "}b+=this.parse(p.tokens,u),c+=this.renderer.listitem(b,x,!!d)}n+=this.renderer.list(c,l,a);continue}case"html":{const i=o;n+=this.renderer.html(i.text,i.block);continue}case"paragraph":{const i=o;n+=this.renderer.paragraph(this.parseInline(i.tokens));continue}case"text":{let i=o,l=i.tokens?this.parseInline(i.tokens):i.text;for(;r+1<e.length&&e[r+1].type==="text";)i=e[++r],l+=`
`+(i.tokens?this.parseInline(i.tokens):i.text);n+=t?this.renderer.paragraph(l):l;continue}default:{const i='Token with "'+o.type+'" type was not found.';if(this.options.silent)return console.error(i),"";throw new Error(i)}}}return n}parseInline(e,t){t=t||this.renderer;let n="";for(let r=0;r<e.length;r++){const o=e[r];if(this.options.extensions&&this.options.extensions.renderers&&this.options.extensions.renderers[o.type]){const i=this.options.extensions.renderers[o.type].call({parser:this},o);if(i!==!1||!["escape","html","link","image","strong","em","codespan","br","del","text"].includes(o.type)){n+=i||"";continue}}switch(o.type){case"escape":{const i=o;n+=t.text(i.text);break}case"html":{const i=o;n+=t.html(i.text);break}case"link":{const i=o;n+=t.link(i.href,i.title,this.parseInline(i.tokens,t));break}case"image":{const i=o;n+=t.image(i.href,i.title,i.text);break}case"strong":{const i=o;n+=t.strong(this.parseInline(i.tokens,t));break}case"em":{const i=o;n+=t.em(this.parseInline(i.tokens,t));break}case"codespan":{const i=o;n+=t.codespan(i.text);break}case"br":{n+=t.br();break}case"del":{const i=o;n+=t.del(this.parseInline(i.tokens,t));break}case"text":{const i=o;n+=t.text(i.text);break}default:{const i='Token with "'+o.type+'" type was not found.';if(this.options.silent)return console.error(i),"";throw new Error(i)}}}return n}}class L{constructor(e){f(this,"options");this.options=e||E}preprocess(e){return e}postprocess(e){return e}processAllTokens(e){return e}}f(L,"passThroughHooks",new Set(["preprocess","postprocess","processAllTokens"]));var O,he,K,lt;class ot{constructor(...e){ne(this,O);ne(this,K);f(this,"defaults",pe());f(this,"options",this.setOptions);f(this,"parse",q(this,O,he).call(this,_.lex,$.parse));f(this,"parseInline",q(this,O,he).call(this,_.lexInline,$.parseInline));f(this,"Parser",$);f(this,"Renderer",X);f(this,"TextRenderer",xe);f(this,"Lexer",_);f(this,"Tokenizer",W);f(this,"Hooks",L);this.use(...e)}walkTokens(e,t){var r,o;let n=[];for(const i of e)switch(n=n.concat(t.call(this,i)),i.type){case"table":{const l=i;for(const a of l.header)n=n.concat(this.walkTokens(a.tokens,t));for(const a of l.rows)for(const u of a)n=n.concat(this.walkTokens(u.tokens,t));break}case"list":{const l=i;n=n.concat(this.walkTokens(l.items,t));break}default:{const l=i;(o=(r=this.defaults.extensions)==null?void 0:r.childTokens)!=null&&o[l.type]?this.defaults.extensions.childTokens[l.type].forEach(a=>{n=n.concat(this.walkTokens(l[a],t))}):l.tokens&&(n=n.concat(this.walkTokens(l.tokens,t)))}}return n}use(...e){const t=this.defaults.extensions||{renderers:{},childTokens:{}};return e.forEach(n=>{const r={...n};if(r.async=this.defaults.async||r.async||!1,n.extensions&&(n.extensions.forEach(o=>{if(!o.name)throw new Error("extension name required");if("renderer"in o){const i=t.renderers[o.name];i?t.renderers[o.name]=function(...l){let a=o.renderer.apply(this,l);return a===!1&&(a=i.apply(this,l)),a}:t.renderers[o.name]=o.renderer}if("tokenizer"in o){if(!o.level||o.level!=="block"&&o.level!=="inline")throw new Error("extension level must be 'block' or 'inline'");const i=t[o.level];i?i.unshift(o.tokenizer):t[o.level]=[o.tokenizer],o.start&&(o.level==="block"?t.startBlock?t.startBlock.push(o.start):t.startBlock=[o.start]:o.level==="inline"&&(t.startInline?t.startInline.push(o.start):t.startInline=[o.start]))}"childTokens"in o&&o.childTokens&&(t.childTokens[o.name]=o.childTokens)}),r.extensions=t),n.renderer){const o=this.defaults.renderer||new X(this.defaults);for(const i in n.renderer){if(!(i in o))throw new Error(`renderer '${i}' does not exist`);if(i==="options")continue;const l=i,a=n.renderer[l],u=o[l];o[l]=(...c)=>{let h=a.apply(o,c);return h===!1&&(h=u.apply(o,c)),h||""}}r.renderer=o}if(n.tokenizer){const o=this.defaults.tokenizer||new W(this.defaults);for(const i in n.tokenizer){if(!(i in o))throw new Error(`tokenizer '${i}' does not exist`);if(["options","rules","lexer"].includes(i))continue;const l=i,a=n.tokenizer[l],u=o[l];o[l]=(...c)=>{let h=a.apply(o,c);return h===!1&&(h=u.apply(o,c)),h}}r.tokenizer=o}if(n.hooks){const o=this.defaults.hooks||new L;for(const i in n.hooks){if(!(i in o))throw new Error(`hook '${i}' does not exist`);if(i==="options")continue;const l=i,a=n.hooks[l],u=o[l];L.passThroughHooks.has(i)?o[l]=c=>{if(this.defaults.async)return Promise.resolve(a.call(o,c)).then(p=>u.call(o,p));const h=a.call(o,c);return u.call(o,h)}:o[l]=(...c)=>{let h=a.apply(o,c);return h===!1&&(h=u.apply(o,c)),h}}r.hooks=o}if(n.walkTokens){const o=this.defaults.walkTokens,i=n.walkTokens;r.walkTokens=function(l){let a=[];return a.push(i.call(this,l)),o&&(a=a.concat(o.call(this,l))),a}}this.defaults={...this.defaults,...r}}),this}setOptions(e){return this.defaults={...this.defaults,...e},this}lexer(e,t){return _.lex(e,t??this.defaults)}parser(e,t){return $.parse(e,t??this.defaults)}}O=new WeakSet,he=function(e,t){return(n,r)=>{const o={...r},i={...this.defaults,...o};this.defaults.async===!0&&o.async===!1&&(i.silent||console.warn("marked(): The async option was set to true by an extension. The async: false option sent to parse will be ignored."),i.async=!0);const l=q(this,K,lt).call(this,!!i.silent,!!i.async);if(typeof n>"u"||n===null)return l(new Error("marked(): input parameter is undefined or null"));if(typeof n!="string")return l(new Error("marked(): input parameter is of type "+Object.prototype.toString.call(n)+", string expected"));if(i.hooks&&(i.hooks.options=i),i.async)return Promise.resolve(i.hooks?i.hooks.preprocess(n):n).then(a=>e(a,i)).then(a=>i.hooks?i.hooks.processAllTokens(a):a).then(a=>i.walkTokens?Promise.all(this.walkTokens(a,i.walkTokens)).then(()=>a):a).then(a=>t(a,i)).then(a=>i.hooks?i.hooks.postprocess(a):a).catch(l);try{i.hooks&&(n=i.hooks.preprocess(n));let a=e(n,i);i.hooks&&(a=i.hooks.processAllTokens(a)),i.walkTokens&&this.walkTokens(a,i.walkTokens);let u=t(a,i);return i.hooks&&(u=i.hooks.postprocess(u)),u}catch(a){return l(a)}}},K=new WeakSet,lt=function(e,t){return n=>{if(n.message+=`
Please report this to https://github.com/markedjs/marked.`,e){const r="<p>An error occurred:</p><pre>"+w(n.message+"",!0)+"</pre>";return t?Promise.resolve(r):r}if(t)return Promise.reject(n);throw n}};const v=new ot;function g(s,e){return v.parse(s,e)}g.options=g.setOptions=function(s){return v.setOptions(s),g.defaults=v.defaults,Je(g.defaults),g};g.getDefaults=pe;g.defaults=E;g.use=function(...s){return v.use(...s),g.defaults=v.defaults,Je(g.defaults),g};g.walkTokens=function(s,e){return v.walkTokens(s,e)};g.parseInline=v.parseInline;g.Parser=$;g.parser=$.parse;g.Renderer=X;g.TextRenderer=xe;g.Lexer=_;g.lexer=_.lex;g.Tokenizer=W;g.Hooks=L;g.parse=g;g.options;g.setOptions;g.use;g.walkTokens;g.parseInline;$.parse;_.lex;function at(s,e){return e=_e.getLanguage(e)?e:"plaintext",s=_e.highlight(s,{language:e}).value,{language:e,code:`<code class="hljs language-${e}">${s}</code>`}}function An(s,e){const{code:t}=at(s,e);return`<pre class="markdown-code-block plain">${t}</pre>`}function Cn(s,e){const{language:t,code:n}=at(s,e);return t==="plaintext"?`<pre class="markdown-code-block plain">${n}</pre>`:`<div class="wrapped-code-container">
    <div class="lang-banner">
        <span>${t}</span>
    </div>
    <pre class="markdown-code-block wrapped">${n}</pre>
</div>`}function ct(s=!1){const e=new ot,t=new e.Renderer;return s?t.code=Cn:t.code=An,e.setOptions({renderer:t}),e.parse.bind(e)}const Fe=ct(!1),Ue=ct(!0);function ut(s,e){let t=null;const n=function(...r){const o=()=>{t=null,s.apply(this,r)};t!==null&&clearTimeout(t),t=setTimeout(o,e)};return n.cancel=function(){t!==null&&(clearTimeout(t),t=null)},n}function Mn(s,e=8){let t=0;return(...n)=>{const r=new Date().getTime();r-t>=e&&(t=r,s(...n))}}const z=[];function Pn(s,e){return s!==s?e===e:s!==e||s&&typeof s=="object"||typeof s=="function"}function y(s,e=re){let t;const n=new Set;function r(a){if(Pn(s,a)&&(s=a,t)){const u=!z.length;for(const c of n)c[1](),z.push(c,s);if(u){for(let c=0;c<z.length;c+=2)z[c][0](z[c+1]);z.length=0}}}function o(a){r(a(s))}function i(a,u=re){const c=[a,u];return n.add(c),n.size===1&&(t=e(r,o)||re),a(s),()=>{n.delete(c),n.size===0&&t&&(t(),t=null)}}const l={_:s,set:r,update:o,subscribe:i};return l.subscribe(a=>l._=a),l}function Ln(s,e){return ht[s](e)}const ht={functions(s){return s?Object.entries(s).reduce((e,[t,n])=>{const r={},{title:o,result_type:i}=n;return o&&(r.title=o),(i==="markdown"||i==="text")&&(r.result_type=i),e[t]=r,e},{}):{}}},Dn={functions:{}};function On(){const s={...y({functions:{}}),setAll(e){this.update(t=>{for(const n in ht){const r=n;t[r]=Ln(r,e[r])}return t})}};return s.set({...Dn}),s}function Fn(){return{...y(!1)}}const Un={Server:!0,Client:!0};function Bn(){return{...y([]),showType(e){return Un[e]},remove(e){this.update(t=>t.filter(n=>n.text!==e))},add(e,t){this._.some(n=>n.text===t)||(console.error(`${e} Error: ${t}`),this.update(n=>(n.push({type:e,text:t}),n)))}}}class qn{constructor(...e){f(this,"instance");this.instance=mt(...e)}on(e,t){this.instance.on(e,t)}emit(e,...t){if(typeof t[t.length-1]=="function"){const n=t.pop();this.instance.emit(e,...t,n)}else this.instance.emit(e,...t)}off(e,t){t?this.instance.off(e,t):this.instance.off(e)}}function Nn(s,e){const t="assistant",n="content"in e&&e.content?e.content:"";if(!(e.tool_calls&&e.tool_calls.length>0))return{id:s,role:t,content:n};const o=e.tool_calls[0];if(!o.id)return{error:"Tool call has no id. Received a partial delta for a tool call that does not exist yet."};if(o.type!=="function")return{error:"Currently, only function tool calls are supported."};const i="function";let{id:l,function:{name:a,arguments:u}}=o;return{id:s,role:t,content:n,tool_calls:[{id:l,type:i,function:{name:a||"",arguments:u||""}}]}}function Zn(s,e){var p;if(s.id!==e.id)throw new Error("Message id and delta id must match");if(e.content&&(s.content=s.content!==null?s.content+e.content:e.content),!(e.tool_calls&&e.tool_calls.length>0))return;const n=e.tool_calls[0],r=n.index;if(typeof r!="number"||!n.function)return;const o=!n.id||!((p=n.function)!=null&&p.name);s.tool_calls||(s.tool_calls=[]);const i=s.tool_calls.length,l=r>i,a=r===i;if(l)return;if(a){if(o)return;const d="function",{id:x,function:{name:b,arguments:T}}=n;return s.tool_calls.push({id:x,type:d,function:{name:b,arguments:T}}),!0}const u=s.tool_calls[r],{function:{name:c,arguments:h}}=n;c&&(u.function.name=c),h&&(u.function.arguments+=h)}const Be={user(s){return{role:"user",id:"id"in s&&s.id?s.id:G(),content:s.content?s.content:""}},assistant(s){var t,n;const e=s.tool_calls&&s.tool_calls.length>0?s.tool_calls:void 0;if(e){for(const r of e)if(!(r.id&&((t=r.function)!=null&&t.name)&&((n=r.function)!=null&&n.arguments)))return null}return{role:"assistant",id:"id"in s&&s.id?s.id:G(),content:s.content??"",tool_calls:e}},tool(s){return s.tool_call_id?{role:"tool",id:"id"in s&&s.id?s.id:G(),content:s.content??"",tool_call_id:s.tool_call_id}:null}};function pt(s){return s.role&&s.role in Be?Be[s.role](s):null}function Hn(s){return s.map(e=>pt(e)).filter(e=>e!==null)}function jn(s){const e=Hn(s);return{order:e.map(t=>t.id),mapping:jt(e,"id")}}const Qn={user(s){let e={role:"user",content:""};if(typeof s.content=="string")e.content=s.content;else{e.content=[];for(const t of s.content)t.type!=="binary"&&e.content.push(t)}return e},assistant(s){let e={role:"assistant",content:s.content};return s.tool_calls&&s.tool_calls.length>0&&(e.tool_calls=s.tool_calls),e},tool(s){return{role:"tool",content:s.content,tool_call_id:s.tool_call_id}}};function Gn(s){return Qn[s.role](s)}function Vn(s,e){return e.map(t=>Gn(s[t])).filter(t=>t!==null)}class Wn{constructor(){f(this,"mapping",y({}));f(this,"order",[])}subscribe(e){return this.mapping.subscribe(t=>e({mapping:t,order:this.order}))}set(e){Qt(this.order,e.order),this.mapping.set(e.mapping)}oaiMessages(){return Vn(this.mapping._,this.order)}serialize(){return{mapping:this.mapping._,order:this.order}}newUserMessage(e){this.setMessage({id:G(),role:"user",content:e})}updateUserMessageContent(e,t){this.mapping.update(n=>{const r=n[e];if(typeof r.content=="string")return r.content=t,n;for(const o of r.content)if(o.type==="text")return o.text=t,n;throw new Error(`Message ${e} has no text content part.`)})}removeAfterId(e){const t=this.order.indexOf(e);t!==-1&&this.removeAfterIndex(t)}removeAfterIndex(e){if(!this.order[e])return;const n=this.order.splice(e+1);this.mapping.update(r=>{for(const o of n)delete r[o];return r})}handleSetAllEvent(e){const{mapping:t,order:n}=jn(e);return this.set({order:n,mapping:t})}handleSetEvent(e){const t=pt(e);if(!t)return`Invalid message: ${e}`;this.setMessage(t)}handleUpdateEvent(e){if(e.role&&e.role!=="assistant")return`Invalid message update: role must be assistant.: ${e}`;const t=e.id;return t?t in this.mapping._?this.updateExistingFromDelta(t,e):this.addNewFromDelta(t,e):`Invalid message update: id not defined.: ${e}`}addNewFromDelta(e,t){const n=Nn(e,t);if("error"in n)return n.error;this.setMessage(n)}updateExistingFromDelta(e,t){let n;return this.mapping.update(r=>{const o=r[e];return(o==null?void 0:o.role)==="assistant"?Zn(o,t):n=`Invalid message update. Existing message '${e}' is not an assistant message.`,r}),n}setMessage(e){e.id in this.mapping._||this.order.push(e.id),this.mapping.update(t=>(t[e.id]=e,t))}}const Jn={async binary(s){const e=await Ce(s,"ArrayBuffer");return{type:"binary",name:s.name,fileType:s.type,content:e}},async image_url(s){return{type:"image_url",image_url:{url:await Ce(s,"DataURL")}}}};function Xn(s){return s.type.startsWith("image")?"image_url":"binary"}class Kn{constructor(){f(this,"text",y(""));f(this,"images",y([]));f(this,"files",y([]))}serialize(){return{text:this.text._,images:this.images._,files:this.files._}}set(e){this.text.set(e.text),this.images.set(e.images),this.files.set(e.files)}clear(){this.text.set(""),this.files.set([]),this.images.set([])}textContentPart(){return{type:"text",text:this.text._}}isEmpty(){return this.text._.trim()===""&&this.files._.length===0&&this.images._.length===0}removeImage(e){this.images.update(t=>(t.splice(e,1),t))}removeFile(e){this.files.update(t=>(t.splice(e,1),t))}addImage(e){this.images.update(t=>(t.push(e),t))}addFile(e){this.files.update(t=>(t.push(e),t))}textIsEmpty(){return this.text._.trim()===""}async upload(){Gt(async e=>{if(!e)return;const t=Xn(e);let n;try{n=await Jn[t](e)}catch{return}n&&(n.type==="image_url"?this.addImage(n):this.addFile(n))})}getContentParts(){let e=[...this.files._,...this.images._];return this.textIsEmpty()||e.push(this.textContentPart()),e}}class Yn{constructor(){f(this,"ghostDiv",y(null));f(this,"containerDiv",y(null));f(this,"autoEnabled",!0);f(this,"lastScrollHeight",0);f(this,"lastScrollTop",0);f(this,"handleUserScrollDebounced",ut(()=>this.handleUserScroll(),100));f(this,"autoScrollThrottled",Mn(()=>this.autoScroll(),200))}scroll(e){e==="force"?this.forceScroll():this.autoScrollThrottled()}handleUserScroll(){if(!this.containerDiv._)return;const{scrollHeight:e,scrollTop:t,clientHeight:n}=this.containerDiv._;t<this.lastScrollTop?this.autoEnabled=!1:e-t<=n+50&&(this.autoEnabled=!0),this.lastScrollTop=t}scrollChat(e=!1){var n;if(!this.containerDiv._)return;const{scrollHeight:t}=this.containerDiv._;e&&t===this.lastScrollHeight||((n=this.ghostDiv._)==null||n.scrollIntoView({behavior:"smooth",block:"start"}),this.lastScrollHeight=t)}autoScroll(){this.autoEnabled&&Re().then(()=>this.scrollChat(!0))}forceScroll(){Re().then(()=>this.scrollChat()),this.autoEnabled=!0}}class es{constructor(e){f(this,"scroll",new Yn);f(this,"rendered",y([]));f(this,"connected",y(!1));f(this,"prompt",new Kn);f(this,"messages",new Wn);f(this,"config",On());f(this,"errors",Bn());f(this,"generating",Fn());f(this,"defaultMessages",y([]));this.socket=e,this.socket=e,this.socket.on("connect",()=>{console.log("connected"),this.connected.set(!0)}),this.socket.on("disconnect",()=>{console.log("disconnected"),this.connected.set(!1)}),this.socket.on("error",t=>this.errors.add("Server",t)),this.socket.on("error",()=>this.generating.set(!1)),this.socket.on("config",t=>this.config.setAll(t)),this.socket.on("generating-started",()=>this.generating.set(!0)),this.socket.on("generating-done",()=>this.generating.set(!1)),this.socket.on("message-set-all",this.handleSetAllEvent.bind(this)),this.socket.on("message-set",this.handleSetEvent.bind(this)),this.socket.on("message-update",this.handleUpdateEvent.bind(this)),this.socket.on("default-messages",t=>{this.defaultMessages.set(t)}),this.defaultMessages.subscribe(()=>this.setMessagesIfDefault()),this.messages.subscribe(()=>this.setMessagesIfDefault()),this.messages.subscribe(({mapping:t,order:n})=>{this.rendered.set(ts(t,n)),this.scroll.scroll("auto")})}setMessagesIfDefault(){this.messages.order.length===0&&this.defaultMessages._.length>0&&this.handleSetAllEvent(this.defaultMessages._)}serialize(){return{prompt:this.prompt.serialize(),messages:this.messages.serialize(),config:this.config._,errors:this.errors._,generating:this.generating._,defaultMessages:this.defaultMessages._}}setFromSerialized(e){e.prompt&&this.prompt.set(e.prompt),e.messages&&this.messages.set(e.messages),e.config&&this.config.set(e.config),e.errors&&this.errors.set(e.errors),e.defaultMessages&&this.defaultMessages.set(e.defaultMessages),e.generating!==void 0&&this.generating.set(e.generating)}handleSetAllEvent(e){this.generating._||(this.messages.handleSetAllEvent(e),this.scroll.scroll("force"))}handleSetEvent(e){if(this.generating._)return;const t=this.messages.handleSetEvent(e);t&&this.errors.add("Client",t)}handleUpdateEvent(e){if(this.generating._)return;const t=this.messages.handleUpdateEvent(e);t&&this.errors.add("Client",t)}reset(){this.messages.handleSetAllEvent([])}upload(){this.prompt.upload()}stopGenerating(){this.generating.set(!1)}sendMessage(){if(this.generating._||this.prompt.isEmpty())return;const e=this.prompt.getContentParts(),t=e.length===1&&e[0].type==="text"?this.prompt.text._:e;this.messages.newUserMessage(t),this.prompt.clear(),this.startGenerating()}changeUserMessageAndSubmit(e,t){this.generating._||(this.messages.updateUserMessageContent(e,t),this.regenerateAfterId(e))}regenerateOnAgentResponse(e){if(this.generating._)return;const t=this.rendered._[e-1];if(!t||t.type!=="user")throw new Error("Tried to regenerate on an index not preceded by a user message");this.regenerateAfterId(t.id)}renderAssistantMarkdown(e){return Ue(e)}renderFunctionCallMarkdown(e){return Ue(e)}renderFunctionCallArgs(e){if(!e)return"";let t;try{t=JSON.stringify(JSON.parse(e),null,2)}catch{t=e}return Fe("```json\n"+t+"\n```")}renderFunctionTitle(e,t){var r;const n=(r=t[e])==null?void 0:r.title;return Fe(n??`Function call to **\`${e}()\`**`)}getFunctionResultType(e,t){var n;return((n=t[e])==null?void 0:n.result_type)??"text"}getFunctionCallStatus(e,t){const n=t&&e===null;return e&&Ht(e)?"error":n?"progress":"complete"}userContentToText(e){if(typeof e=="string")return e;for(const t of e)if(t.type==="text")return t.text;return""}userContentToFiles(e){return typeof e=="string"?[]:e.filter(t=>t.type!=="text")}regenerateAfterId(e){this.messages.removeAfterId(e),this.startGenerating()}startGenerating(){this.socket.emit("start-generating",{messages:this.messages.oaiMessages()}),this.generating.set(!0),this.scroll.scroll("force")}}function ts(s,e){let t=e.map(o=>s[o]),n,r=[];for(;t.length>0&&(n=t.shift());){if(n.role==="user"){r.push({id:n.id,type:"user",content:n.content});continue}const o={type:"agent",parts:[]};for(t.unshift(n);t[0]&&t[0].role!=="user";){const i=t.shift(),l=i.role,a=i.content??"";if(l==="assistant"){o.parts.push({type:"content",content:a});const{tool_calls:c}=i;if(c&&c.length>0)for(let{id:h,function:{name:p,arguments:d}}of c)p=p??"",d=d??"",o.parts.push({type:"tool_call",id:h,name:p,arguments:d,result:null});continue}const u=i.tool_call_id;for(let c=o.parts.length-1;c>=0;c--){let h=o.parts[c];if(h.type==="tool_call"&&h.id===u){h.result=i.content;break}}}r.push(o)}return r}const ns="dark";function ss(){const s={...y(!1),checkDarkModePreferred(){return!!window.matchMedia("(prefers-color-scheme: dark)").matches},updateDocument(e){document.documentElement.classList[e?"add":"remove"](ns)}};return s.subscribe(s.updateDocument.bind(s)),s.set(s.checkDarkModePreferred()),s}function rs(s){let e,t,n;var r=s[0];function o(i,l){return{props:{chat:i[1]}}}return r&&(e=Se(r,o(s))),{c(){e&&Ie(e.$$.fragment),t=St()},m(i,l){e&&ae(e,i,l),Tt(i,t,l),n=!0},p(i,[l]){if(l&1&&r!==(r=i[0])){if(e){At();const a=e;ze(a.$$.fragment,1,0,()=>{ce(a,1)}),Ct()}r?(e=Se(r,o(i)),Ie(e.$$.fragment),le(e.$$.fragment,1),ae(e,t.parentNode,t)):e=null}},i(i){n||(e&&le(e.$$.fragment,i),n=!0)},o(i){e&&ze(e.$$.fragment,i),n=!1},d(i){i&&He(t),e&&ce(e,i)}}}function is(s,e,t){let n;Rt(async()=>{t(0,n=(await bt(()=>import("./Chat-aJQKS0-F.js"),__vite__mapDeps([0,1]))).default)});const r="",o=new qn(r,{transports:["websocket"]});o.on("connect",()=>console.log("CONNECTED")),ss();const i=new es(o),l=Vt("chat");l&&i.setFromSerialized(l);const a=ut(()=>{setTimeout(()=>{Wt("chat",i.serialize())})},500);return i.messages.subscribe(a),i.prompt.files.subscribe(a),i.prompt.images.subscribe(a),i.prompt.text.subscribe(a),i.errors.subscribe(a),i.config.subscribe(a),[n,i]}class os extends Lt{constructor(e){super(),Pt(this,e,is,rs,yt,{})}}new os({target:document.getElementById("app")});export{Ct as A,ce as B,Ss as C,je as D,$s as E,St as F,ks as G,Ts as H,us as I,hs as J,Lt as S,le as a,_s as b,Tt as c,Ne as d,xs as e,He as f,vs as g,Re as h,Pt as i,ve as j,bs as k,ys as l,ms as m,V as n,Rt as o,ps as p,ws as q,F as r,yt as s,ze as t,Ie as u,ae as v,ds as w,gs as x,fs as y,At as z};
function __vite__mapDeps(indexes) {
  if (!__vite__mapDeps.viteFileDeps) {
    __vite__mapDeps.viteFileDeps = ["assets/Chat-aJQKS0-F.js","assets/Chat-Ur87eT8K.css"]
  }
  return indexes.map((i) => __vite__mapDeps.viteFileDeps[i])
}